<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
      <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["http"]);
        });
      </script>
  </head>

  <body class="index">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="images/navbar.png" />
      </span>
    </a>
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="lang-selector">
              <a href="#" data-language-name="http">http</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc">
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        
          <h1 id="authentication">Authentication</h1>

<p>When successfully registered or logged-in, the server will provide some informations in the response header.</p>

<table><thead>
<tr>
<th style="text-align: center">Parameter</th>
<th style="text-align: center">Description</th>
<th style="text-align: left">Example</th>
</tr>
</thead><tbody>
<tr>
<td style="text-align: center">access_token</td>
<td style="text-align: center">Token to identified the user.</td>
<td style="text-align: left">6nwOYtNyKYYcDBUsvlThNw</td>
</tr>
<tr>
<td style="text-align: center">client</td>
<td style="text-align: center">String to identifying the request.</td>
<td style="text-align: left">APVqtK9VEqg10GwOHMKlxw</td>
</tr>
<tr>
<td style="text-align: center">expiry</td>
<td style="text-align: center">The token expiration (the client <strong>WILL NOT</strong> expire.</td>
<td style="text-align: left">19673829</td>
</tr>
<tr>
<td style="text-align: center">uid</td>
<td style="text-align: center">The token unique identifier</td>
<td style="text-align: left"><ul><li>foo@bar.com (for email registration)</li><li>23894012 (for Facebook Registration)</li></ul></td>
</tr>
</tbody></table>

<p>To interact with the API, you will need to specify those headers.</p>

<blockquote>
<p>CURL Example</p>
</blockquote>
<pre><code class="highlight shell">curl -XPOST localhost:3000/users/1/follow/2
    -H <span class="s1">'Content-Type: application/json'</span>
    -H <span class="s1">'access-token: 6nwOYtNyKYYcDBUsvlThNw'</span>
    -H <span class="s1">'client: APVqtK9VEqg10GwOHMKlxw'</span>
    -H <span class="s2">"uid: kiel_flatley@schulist.net"</span>
</code></pre>

          <h1 id="login">Login</h1>

<h2 id="with-email">With Email</h2>

<blockquote>
<p>Request JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="nf">POST</span> <span class="nn">/users/auth/sign_in</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<aside>
<b>POST</b> <i>/users/auth/sign_in</i>
</aside>

<p>You&rsquo;ll receive the authentication informations in the header of the server response.</p>

<h2 id="with-facebook">With Facebook</h2>

<blockquote>
<p>Request JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="nf">GET</span> <span class="nn">/auth/facebook_access_token/callback</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"access_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"azoepazeqsd"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<aside>
<b>POST</b> <i>/users/auth/facebook/callback</i>
</aside>

<p>You&rsquo;ll receive the authentication informations in the header of the server response.</p>

          <h1 id="registration">Registration</h1>

<h2 id="with-email">With Email</h2>

<blockquote>
<p>Request JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="nf">POST</span> <span class="nn">/users/auth</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"password"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<aside>
<b>POST</b> <i>/users/auth</i>
</aside>

<p>You&rsquo;ll receive the authentication informations in the header of the server response.</p>

<h2 id="with-facebook">With Facebook</h2>

<blockquote>
<p>Request JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="nf">GET</span> <span class="nn">/auth/facebook_access_token/callback</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"acess_token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"azeaze"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"email"</span><span class="p">:</span><span class="w"> </span><span class="s2">"foo@bar.com"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<aside>
<b>POST</b> <i>/users/auth/facebook/callback</i>
</aside>

<p>You&rsquo;ll receive the authentication informations in the header of the server response.</p>

          <h1 id="users">Users</h1>

          <h1 id="baskets">Baskets</h1>

          <h2 id="create">Create</h2>

<blockquote>
<p>Request JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="nf">POST</span> <span class="nn">/shops/:id/baskets</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"vendor_id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w">
  </span><span class="s2">"product_ids"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">201</span> <span class="ne">Created</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"basket"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w">
    </span><span class="s2">"total"</span><span class="p">:</span><span class="w"> </span><span class="mf">11.50</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<aside>
<b>POST</b> <i>/shops/:id/baskets</i>
</aside>

          <h2 id="pay">Pay</h2>

<blockquote>
<p>Request JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="nf">POST</span> <span class="nn">/baskets/:basket_id/pay</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"to_be_defined"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>Response JSON</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">Ok</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
  </span><span class="s2">"basket"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="s2">"payed"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<aside>
<b>POST</b> <i>/baskets/:basket_id/pay</i>
</aside>

          <h1 id="errors">Errors</h1>

<blockquote>
<p>400 (Bad request)</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">400</span> <span class="ne">Bad Request</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"......."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>401 (Forbidden)</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">401</span> <span class="ne">Forbidden</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"reason"</span><span class="p">:</span><span class="w"> </span><span class="s2">"......."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>200 (OK) with errors (only known=documented user codes)
<br />
<code class="prettyprint">special meaning</code></p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"error_email_taken"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"email is already taken"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p><code class="prettyprint">refers to username with server side error reason (to show to the user)</code></p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="kc">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"error_username"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"use numbers and letters"</span><span class="p">,</span><span class="w"> </span><span class="s2">"too short"</span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

<blockquote>
<p>401 (Unauthorized)</p>
</blockquote>
<pre><code class="highlight http"><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">401</span> <span class="ne">Unauthorized</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="s2">"errors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"error_session"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"not logged in"</span><span class="p">],</span><span class="w">
        </span><span class="s2">"error_session_expired"</span><span class="p">:[]</span><span class="w">
        </span><span class="s2">"error_not_authorized"</span><span class="err">:</span><span class="p">[]</span><span class="w">
    </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="http">http</a>
          </div>
      </div>
    </div>
  </body>
</html>
